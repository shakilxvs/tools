<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS DETECT - XVS Tools</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(180deg, #000000 0%, #1a0a2e 50%, #0f0520 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .back-button {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-size: 1rem;
            cursor: pointer;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        h1 {
            color: white;
            font-size: 3.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 60px;
            letter-spacing: -1px;
        }

        .url-input-container {
            background: #6b4ce6;
            border-radius: 15px;
            margin-bottom: 40px;
        }

        .url-input {
            width: 100%;
            background: transparent;
            border: none;
            padding: 28px 35px;
            font-size: 1.4rem;
            color: white;
            outline: none;
        }

        .url-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .detect-button {
            width: 100%;
            background: #16a085;
            border: none;
            border-radius: 15px;
            padding: 30px 50px;
            font-size: 2rem;
            font-weight: 700;
            color: white;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            margin-bottom: 40px;
        }

        .detect-button:hover {
            background: #1abc9c;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(22, 160, 133, 0.4);
        }

        .result-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 40px;
            display: none;
        }

        .result-container.active {
            display: block;
        }

        .result-title {
            color: white;
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 25px;
        }

        .cms-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 12px;
        }

        .info-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .info-value {
            color: white;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .technologies-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .tech-tag {
            background: #6b4ce6;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.95rem;
        }

        .footer-note {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.1rem;
            margin-top: 80px;
            font-style: italic;
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.3rem;
            padding: 20px;
            display: none;
        }

        .loading.active {
            display: block;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            .cms-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="back-button" onclick="window.location.href='https://shakilxvs.github.io/tools/">‚Üê Back to Tools</button>
        
        <h1>CMS DETECT</h1>

        <div class="url-input-container">
            <input 
                type="text" 
                class="url-input" 
                id="urlInput"
                placeholder="https://example.com"
                autocomplete="off"
            >
        </div>

        <button class="detect-button" id="detectBtn">DETECT CMS</button>

        <div class="loading" id="loading">üîç Analyzing website...</div>

        <div class="result-container" id="resultContainer">
            <div class="result-title">Detection Results</div>
            
            <div class="cms-info">
                <div class="info-card">
                    <div class="info-label">CMS Detected</div>
                    <div class="info-value" id="cmsName">-</div>
                </div>
                
                <div class="info-card">
                    <div class="info-label">Version</div>
                    <div class="info-value" id="cmsVersion">-</div>
                </div>
                
                <div class="info-card">
                    <div class="info-label">Confidence</div>
                    <div class="info-value" id="confidence">-</div>
                </div>
            </div>

            <div class="info-label">Technologies Detected</div>
            <div class="technologies-list" id="techList"></div>
        </div>

        <div class="footer-note">
            *Not for general use. Educational purpose only.
        </div>
    </div>

    <script>
        const urlInput = document.getElementById('urlInput');
        const detectBtn = document.getElementById('detectBtn');
        const loading = document.getElementById('loading');
        const resultContainer = document.getElementById('resultContainer');

        // CMS Detection Patterns
        const CMS_PATTERNS = {
            WordPress: {
                patterns: [
                    /wp-content/i,
                    /wp-includes/i,
                    /wp-json/i,
                    /<meta name="generator" content="WordPress/i,
                    /\/wp-admin\//i,
                    /\/wp-login\.php/i
                ],
                versionPattern: /WordPress[\/\s]+(\d+\.\d+(?:\.\d+)?)/i,
                confidence: 95,
                tech: ['PHP', 'MySQL']
            },
            Shopify: {
                patterns: [
                    /cdn\.shopify\.com/i,
                    /myshopify\.com/i,
                    /Shopify\.theme/i,
                    /shopify-section/i,
                    /"Shopify":/i,
                    /\/s\/files\/\d+\/\d+\/\d+\/shopify/i,
                    /Shopify\.cdnHost/i,
                    /shopifycdn\.com/i
                ],
                versionPattern: null,
                confidence: 98,
                tech: ['Ruby on Rails', 'Liquid', 'JavaScript']
            },
            Wix: {
                patterns: [
                    /static\.wixstatic\.com/i,
                    /parastorage\.com/i,
                    /wix\.com/i,
                    /_wix_/i,
                    /wixpress\.com/i
                ],
                versionPattern: null,
                confidence: 95,
                tech: ['React', 'Node.js', 'JavaScript']
            },
            Squarespace: {
                patterns: [
                    /static1\.squarespace\.com/i,
                    /squarespace\.com/i,
                    /squarespace-cdn\.com/i,
                    /"Squarespace"/i
                ],
                versionPattern: null,
                confidence: 95,
                tech: ['JavaScript', 'Node.js']
            },
            Joomla: {
                patterns: [
                    /\/components\/com_/i,
                    /\/media\/jui\//i,
                    /<meta name="generator" content="Joomla/i,
                    /option=com_/i,
                    /\/administrator\/index\.php/i
                ],
                versionPattern: /Joomla[!\/\s]+(\d+\.\d+(?:\.\d+)?)/i,
                confidence: 90,
                tech: ['PHP', 'MySQL']
            },
            Drupal: {
                patterns: [
                    /\/sites\/default\/files/i,
                    /\/misc\/drupal/i,
                    /<meta name="generator" content="Drupal/i,
                    /Drupal\.settings/i,
                    /\/node\/\d+/i
                ],
                versionPattern: /Drupal[\/\s]+(\d+)/i,
                confidence: 90,
                tech: ['PHP', 'MySQL']
            },
            Magento: {
                patterns: [
                    /\/static\/version\d+/i,
                    /mage\/cookies/i,
                    /Magento/i,
                    /\/skin\/frontend\//i,
                    /Magento_/i
                ],
                versionPattern: /Magento[\/\s]+(\d+\.\d+)/i,
                confidence: 90,
                tech: ['PHP', 'MySQL', 'Zend Framework']
            },
            PrestaShop: {
                patterns: [
                    /prestashop/i,
                    /\/modules\/\w+\//i,
                    /\/themes\/\w+\//i,
                    /prestashop\.com/i
                ],
                versionPattern: /PrestaShop[\/\s]+(\d+\.\d+)/i,
                confidence: 90,
                tech: ['PHP', 'MySQL', 'Smarty']
            },
            Webflow: {
                patterns: [
                    /webflow/i,
                    /assets\.website-files\.com/i,
                    /"wf-"/i,
                    /webflow\.com/i
                ],
                versionPattern: null,
                confidence: 90,
                tech: ['HTML5', 'CSS3', 'JavaScript']
            },
            BigCommerce: {
                patterns: [
                    /bigcommerce\.com/i,
                    /cdn\d+\.bigcommerce\.com/i,
                    /"BigCommerce"/i
                ],
                versionPattern: null,
                confidence: 90,
                tech: ['PHP', 'JavaScript']
            },
            Ghost: {
                patterns: [
                    /ghost/i,
                    /\/ghost\//i,
                    /content\/themes/i,
                    /<meta name="generator" content="Ghost/i
                ],
                versionPattern: /Ghost[\/\s]+(\d+\.\d+)/i,
                confidence: 85,
                tech: ['Node.js', 'Handlebars', 'JavaScript']
            },
            Blogger: {
                patterns: [
                    /blogspot\.com/i,
                    /blogger\.com/i,
                    /"Blogger"/i
                ],
                versionPattern: null,
                confidence: 95,
                tech: ['Google Infrastructure']
            },
            Weebly: {
                patterns: [
                    /weebly\.com/i,
                    /editmysite\.com/i,
                    /"Weebly"/i
                ],
                versionPattern: null,
                confidence: 90,
                tech: ['JavaScript']
            },
            WooCommerce: {
                patterns: [
                    /woocommerce/i,
                    /\/woocommerce\//i,
                    /wc-/i
                ],
                versionPattern: /WooCommerce[\/\s]+(\d+\.\d+)/i,
                confidence: 85,
                tech: ['WordPress', 'PHP', 'MySQL']
            },
            Elementor: {
                patterns: [
                    /elementor/i,
                    /\/elementor\//i
                ],
                versionPattern: /Elementor[\/\s]+(\d+\.\d+)/i,
                confidence: 80,
                tech: ['WordPress', 'PHP']
            }
        };

        // Technology detection patterns
        const TECH_PATTERNS = {
            'jQuery': /jquery/i,
            'React': /react/i,
            'Angular': /angular/i,
            'Vue.js': /vue\.js|vuejs/i,
            'Bootstrap': /bootstrap/i,
            'Tailwind CSS': /tailwind/i,
            'Google Analytics': /google-analytics|gtag|ga\.js/i,
            'Google Tag Manager': /googletagmanager/i,
            'Cloudflare': /cloudflare|__cfduid/i,
            'Font Awesome': /font-awesome|fontawesome/i,
            'Stripe': /stripe/i,
            'PayPal': /paypal/i,
            'Hotjar': /hotjar/i,
            'Intercom': /intercom/i,
            'Disqus': /disqus/i,
            'AddThis': /addthis/i,
            'Nginx': /nginx/i,
            'Apache': /apache/i,
            'PHP': /\.php|x-powered-by.*php/i,
            'Node.js': /node\.js|nodejs/i,
            'Next.js': /next\.js|_next/i,
            'Gatsby': /gatsby/i,
            'Nuxt.js': /nuxt/i
        };

        function normalizeUrl(url) {
            url = url.trim();
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            return url;
        }

        async function fetchWebsiteContent(url) {
            // Try multiple CORS proxies in sequence
            const proxies = [
                `https://api.allorigins.win/raw?url=${encodeURIComponent(url)}`,
                `https://corsproxy.io/?${encodeURIComponent(url)}`,
                `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,
                `https://thingproxy.freeboard.io/fetch/${encodeURIComponent(url)}`
            ];

            let lastError = null;

            for (let i = 0; i < proxies.length; i++) {
                try {
                    const response = await fetch(proxies[i], {
                        method: 'GET',
                        headers: {
                            'Accept': 'text/html,application/xhtml+xml,application/xml',
                        },
                        signal: AbortSignal.timeout(10000) // 10 second timeout
                    });

                    if (response.ok) {
                        const html = await response.text();
                        if (html && html.length > 100) {
                            return html;
                        }
                    }
                } catch (error) {
                    lastError = error;
                    console.log(`Proxy ${i + 1}/${proxies.length} failed, trying next...`);
                    continue;
                }
            }

            throw lastError || new Error('All proxies failed');
        }

        function detectCMS(html) {
            let detectedCMS = null;
            let highestConfidence = 0;
            let version = 'N/A';
            const technologies = new Set();

            // Detect CMS
            for (const [cmsName, config] of Object.entries(CMS_PATTERNS)) {
                let matches = 0;
                
                for (const pattern of config.patterns) {
                    if (pattern.test(html)) {
                        matches++;
                    }
                }

                const matchRatio = matches / config.patterns.length;
                const confidence = Math.round(matchRatio * config.confidence);

                if (matches > 0 && confidence > highestConfidence) {
                    highestConfidence = confidence;
                    detectedCMS = cmsName;
                    
                    // Try to detect version
                    if (config.versionPattern) {
                        const versionMatch = html.match(config.versionPattern);
                        if (versionMatch && versionMatch[1]) {
                            version = versionMatch[1];
                        }
                    }

                    // Add CMS-specific technologies
                    config.tech.forEach(tech => technologies.add(tech));
                }
            }

            // Detect additional technologies
            for (const [tech, pattern] of Object.entries(TECH_PATTERNS)) {
                if (pattern.test(html)) {
                    technologies.add(tech);
                }
            }

            return {
                cms: detectedCMS || 'Unknown',
                version: version,
                confidence: highestConfidence > 0 ? `${highestConfidence}%` : '0%',
                technologies: Array.from(technologies).slice(0, 12)
            };
        }

        async function performDetection(url) {
            try {
                loading.classList.add('active');
                resultContainer.classList.remove('active');

                const html = await fetchWebsiteContent(url);
                const result = detectCMS(html);

                // Update UI
                document.getElementById('cmsName').textContent = result.cms;
                document.getElementById('cmsVersion').textContent = result.version;
                document.getElementById('confidence').textContent = result.confidence;

                const techList = document.getElementById('techList');
                techList.innerHTML = '';

                if (result.technologies.length > 0) {
                    result.technologies.forEach(tech => {
                        const tag = document.createElement('div');
                        tag.className = 'tech-tag';
                        tag.textContent = tech;
                        techList.appendChild(tag);
                    });
                } else {
                    const tag = document.createElement('div');
                    tag.className = 'tech-tag';
                    tag.textContent = 'No additional technologies detected';
                    techList.appendChild(tag);
                }

                loading.classList.remove('active');
                resultContainer.classList.add('active');

            } catch (error) {
                loading.classList.remove('active');
                console.error('Detection error:', error);
                
                // Show error in results
                document.getElementById('cmsName').textContent = 'Detection Failed';
                document.getElementById('cmsVersion').textContent = 'N/A';
                document.getElementById('confidence').textContent = '0%';
                
                const techList = document.getElementById('techList');
                techList.innerHTML = '';
                const tag = document.createElement('div');
                tag.className = 'tech-tag';
                tag.textContent = 'Unable to analyze - Site may block automated requests';
                techList.appendChild(tag);
                
                resultContainer.classList.add('active');
            }
        }

        detectBtn.addEventListener('click', async () => {
            const url = urlInput.value.trim();

            if (!url) {
                alert('Please enter a website URL!');
                return;
            }

            const normalizedUrl = normalizeUrl(url);

            try {
                new URL(normalizedUrl);
            } catch (e) {
                alert('Please enter a valid URL!');
                return;
            }

            await performDetection(normalizedUrl);
        });

        urlInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                detectBtn.click();
            }
        });
    </script>
</body>
</html>
